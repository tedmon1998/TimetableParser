# Система управления сокращениями

## Описание

Система позволяет вынести словарь сокращений в отдельный файл и автоматически дополнять его при обработке разных расписаний.

## Структура файлов

1. **`abbreviations.json`** - файл с сокращениями (можно редактировать вручную)
2. **`normalize_disciplines.py`** - скрипт нормализации (использует abbreviations.json)
3. **`extract_abbreviations.py`** - скрипт для автоматического извлечения новых сокращений

## Варианты использования

### Вариант 1: Ручное редактирование (рекомендуется)

1. Отредактируйте `abbreviations.json` вручную, добавив новые сокращения
2. Запустите нормализацию:
   ```bash
   python3 normalize_disciplines.py
   ```

**Преимущества:**

- Полный контроль над сокращениями
- Можно добавлять специфичные для института сокращения
- Нет ложных срабатываний

**Недостатки:**

- Требует ручной работы

### Вариант 2: Автоматическое извлечение

1. Запустите скрипт извлечения сокращений:

   ```bash
   python3 extract_abbreviations.py
   ```

   или с указанием конкретных файлов:

   ```bash
   python3 extract_abbreviations.py timetable.json timetable_normalized.json
   ```

2. Скрипт:
   - Загружает все существующие сокращения из всех файлов `abbreviations*.json`
   - Добавляет известные паттерны сокращений (медицинские термины и др.)
   - Анализирует все `timetable*.json` файлы и находит новые сокращения
   - Сохраняет все сокращения в `abbreviations.json`

3. Запустите нормализацию:
   ```bash
   python3 normalize_disciplines.py
   ```

**Преимущества:**

- Автоматическое обнаружение новых сокращений
- Работает с несколькими файлами расписаний

**Недостатки:**

- Могут быть ложные срабатывания
- Требует проверки результатов

### Вариант 3: Комбинированный подход (лучший вариант)

1. **Первичная настройка:**

   ```bash
   # Извлекаем сокращения из всех расписаний
   python3 extract_abbreviations.py
   ```

2. **Ручная проверка и редактирование:**
   - Откройте `abbreviations.json`
   - Проверьте найденные сокращения
   - Удалите неправильные
   - Добавьте недостающие вручную

3. **Использование:**

   ```bash
   python3 normalize_disciplines.py
   ```

4. **При появлении новых расписаний:**
   ```bash
   # Снова запустите извлечение
   python3 extract_abbreviations.py
   # Проверьте и отредактируйте abbreviations.json
   # Запустите нормализацию
   ```

## Формат abbreviations.json

```json
{
  "abbreviations": {
    "Медицинские термины": {
      "\\bМедиц\\.": "Медицинская",
      "\\bэмбр\\.": "эмбриология"
    },
    "Другие": {
      "\\bГЧ": "генетики человека"
    }
  },
  "metadata": {
    "version": "1.0",
    "last_updated": "2026-01-26"
  }
}
```

## Как работает скрипт extract_abbreviations.py

1. **Загрузка существующих сокращений:**
   - Ищет все файлы `abbreviations*.json` в текущей директории
   - Загружает сокращения из всех найденных файлов
   - Объединяет их в один словарь

2. **Добавление известных паттернов:**
   - Добавляет все известные паттерны сокращений (медицинские термины и др.)
   - Это гарантирует, что все стандартные сокращения будут присутствовать

3. **Поиск новых сокращений:**
   - Анализирует названия дисциплин из файлов расписаний
   - Ищет сокращения с точкой (например, "Медиц.", "эмбр.")
   - Ищет аббревиатуры без точки (например, "ГЧ")
   - Пытается найти полную форму сокращения в других дисциплинах

4. **Сохранение:**
   - Объединяет существующие и новые сокращения
   - Группирует по категориям (Медицинские термины, Другие)
   - Сохраняет в `abbreviations.json`

## Работа с разными институтами

### Вариант A: Один общий файл (проще)

Используйте один `abbreviations.json` для всех институтов:

- Все сокращения в одном месте
- Проще поддерживать
- Могут быть конфликты между институтами

### Вариант B: Отдельные файлы по институтам (гибче)

Создайте файлы для каждого института:

- `abbreviations_medical.json`
- `abbreviations_technical.json`
- и т.д.

Использование:

```bash
python3 normalize_disciplines.py abbreviations_medical.json
```

**Преимущества:**

- Нет конфликтов между институтами
- Можно иметь специфичные сокращения

**Недостатки:**

- Больше файлов для поддержки

### Вариант C: Иерархическая структура (самый гибкий)

Создайте структуру:

```
abbreviations/
  ├── base.json          # Общие сокращения
  ├── medical.json       # Медицинский институт
  └── technical.json     # Технический институт
```

Модифицируйте `normalize_disciplines.py` для загрузки нескольких файлов:

```python
base_abbrev = load_abbreviations('abbreviations/base.json')
institute_abbrev = load_abbreviations('abbreviations/medical.json')
ABBREVIATIONS = {**base_abbrev, **institute_abbrev}  # Объединяем
```

## Примеры команд

```bash
# Нормализация с файлом по умолчанию
python3 normalize_disciplines.py

# Нормализация с указанным файлом сокращений
python3 normalize_disciplines.py abbreviations_medical.json

# Извлечение сокращений из всех расписаний
python3 extract_abbreviations.py

# Извлечение из конкретных файлов (нужно модифицировать скрипт)
python3 extract_abbreviations.py timetable_medical.json timetable_technical.json
```

## Рекомендации

1. **Начните с варианта 3** (комбинированный подход)
2. **Используйте вариант B** (отдельные файлы), если у институтов сильно различаются сокращения
3. **Регулярно запускайте** `extract_abbreviations.py` при добавлении новых расписаний
4. **Всегда проверяйте** автоматически найденные сокращения перед использованием
