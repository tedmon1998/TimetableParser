# Скрипты для работы с расписаниями СурГУ

## Структура папок

После работы скриптов создается следующая структура:

```
timetable/
├── schedules_pdf/          # Скачанные PDF файлы расписаний
│   ├── medical_Лечебное_дело-13-01-26.pdf
│   ├── polytechnic_Информатика-26-12-25.pdf
│   └── ...
├── schedules_json/         # Распарсенные JSON файлы
│   ├── medical_Лечебное_дело-13-01-26.json
│   ├── polytechnic_Информатика-26-12-25.json
│   └── ...
└── schedules_parsed/        # Обработанные/нормализованные данные (опционально)
```

## Установка зависимостей

```bash
pip install pdfplumber requests beautifulsoup4 lxml
```

или

```bash
pip install -r requirements.txt
```

## Использование

### 1. Скачивание расписаний с сайта

```bash
python3 download_schedules.py
```

Скрипт:
- Парсит страницу https://www.surgu.ru/ucheba/raspisanie/ochnaya-forma-obucheniya
- Находит все ссылки на PDF файлы
- Определяет институт/направление по тексту ссылки
- Скачивает файлы в папку `schedules_pdf/`
- Называет файлы логически: `{институт}_{название}.pdf`

**Примеры имен файлов:**
- `medical_Лечебное_дело-13-01-26.pdf`
- `polytechnic_Информатика-26-12-25.pdf`
- `economics_Экономика-26-12-25.pdf`

### 2. Парсинг одного PDF файла

```bash
python3 parse_timetable.py schedules_pdf/medical_Лечебное_дело-13-01-26.pdf
```

или автоматически найдет все PDF в папке `schedules_pdf/`:

```bash
python3 parse_timetable.py
```

Результат сохраняется в `schedules_json/` с тем же именем, но расширением `.json`.

### 3. Массовый парсинг всех PDF

```bash
python3 parse_all_schedules.py
```

Парсит все PDF файлы из `schedules_pdf/` и сохраняет JSON в `schedules_json/`.

### 4. Нормализация названий дисциплин

```bash
python3 normalize_disciplines.py
```

Нормализует все JSON файлы в `schedules_json/` (нужно модифицировать скрипт для работы с папкой).

## Определение институтов

Скрипт автоматически определяет институт по ключевым словам:

- `медицинск` → `medical`
- `политехническ` → `polytechnic`
- `экономик` → `economics`
- `гуманитарн` → `humanities`
- `государств` → `state_law`
- `естественн` → `natural_sciences`
- `средн` → `secondary_medical`

Если институт не определен, используется транслитерация названия из текста ссылки.

## Полный цикл работы

```bash
# 1. Скачать все расписания
python3 download_schedules.py

# 2. Распарсить все PDF
python3 parse_all_schedules.py

# 3. Нормализовать названия дисциплин (для каждого JSON)
# (нужно модифицировать normalize_disciplines.py для работы с папкой)
```

## Примечания

- Скрипт делает задержку 0.5 сек между запросами, чтобы не перегружать сервер
- Если файл уже существует, он будет перезаписан
- Все файлы сохраняются с UTF-8 кодировкой
- Имена файлов очищаются от недопустимых символов

